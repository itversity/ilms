
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RDBMS Concepts and Database Operations &#8212; My Jupyter Book</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">My Jupyter Book</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="content.html">
   Mastering Postgresql
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_getting_started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_writing_basic_sql_queries.html">
   Writing Basic SQL Queries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_creating_tables_and_indexes.html">
   Creating Tables and Indexes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_partitioning_tables_and_indexes.html">
   Partitioning Tables and Indexes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_predefined_functions.html">
   Pre-Defined Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_writing_advanced_sql_queries.html">
   Writing Advanced SQL Queries
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/02_rdbms_concepts_and_crud_operations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/02_rdbms_concepts_and_crud_operations.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#normalization-principles">
   Normalization Principles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tables-as-relations">
   Tables as Relations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#database-operations-overview">
   Database Operations - Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#crud-operations">
   CRUD Operations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-table">
   Creating Table
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inserting-data">
   Inserting Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#updating-data">
   Updating Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deleting-data">
   Deleting Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-of-transactions">
   Overview of Transactions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-database-operations">
   Exercise - Database Operations
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="rdbms-concepts-and-database-operations">
<h1>RDBMS Concepts and Database Operations<a class="headerlink" href="#rdbms-concepts-and-database-operations" title="Permalink to this headline">¶</a></h1>
<p>Let us understand how to perform CRUD operations using Postgresql.</p>
<ul class="simple">
<li><p>Normalization Principles</p></li>
<li><p>Tables as Relations</p></li>
<li><p>Database Operations - Overview</p></li>
<li><p>CRUD Operations</p></li>
<li><p>Creating Table</p></li>
<li><p>Inserting Data</p></li>
<li><p>Updating and Deleting Data</p></li>
<li><p>Overview of Transactions</p></li>
<li><p>Exercise - Database Operations</p></li>
</ul>
<div class="section" id="normalization-principles">
<h2>Normalization Principles<a class="headerlink" href="#normalization-principles" title="Permalink to this headline">¶</a></h2>
<p>Let us get an overview about Normalization Principles.</p>
<p>Here are different normal forms we use.</p>
<ul class="simple">
<li><p>1st Normal Form</p></li>
<li><p>2nd Normal Form</p></li>
<li><p>3rd Normal Form</p></li>
<li><p>Boyce Codd Normal Form</p></li>
</ul>
<p>Most of the well designed Data Models will be in either 3rd Normal Form or Boyce Codd Normal Form.</p>
</div>
<div class="section" id="tables-as-relations">
<h2>Tables as Relations<a class="headerlink" href="#tables-as-relations" title="Permalink to this headline">¶</a></h2>
<p>Let us understand details about relations and different types of relationships we typically use.</p>
<ul class="simple">
<li><p>In RDBMS - R stands for Relational.</p></li>
<li><p>In the transactional systemes, tables are created using normalization principles. There will be relations or tables created based on relationships among them.</p></li>
<li><p>Here are the typical relationships among the tables.</p>
<ul>
<li><p>1 to 1</p></li>
<li><p>1 to many or many to 1 (1 to n or n to 1)</p></li>
<li><p>many to many (m to n)</p></li>
</ul>
</li>
<li><p>To <strong>enforce</strong> relationships we typically define constraints such as <strong>Primary Key</strong> and <strong>Foreign Key</strong>.</p></li>
<li><p>Here is the typical process we follow from requirements to physical database tables before building applications.</p>
<ul>
<li><p>Identify entities based up on the requirements.</p></li>
<li><p>Defined relationships among them.</p></li>
<li><p>Create ER Diagram (Entity Relationship Diagram). It is also called as Logical Data Model.</p></li>
<li><p>Apply Normalization Principles on the entities to identify tables and constraints to manage relationships among them.</p></li>
<li><p>Come up with Physical Data Model and generate required DDL Scripts.</p></li>
<li><p>Execute the scripts in the database on which applications will be eventually build based up on business requirements.</p></li>
</ul>
</li>
<li><p>Let us go through some business requirements and define relationships between logical entities.</p></li>
</ul>
</div>
<div class="section" id="database-operations-overview">
<h2>Database Operations - Overview<a class="headerlink" href="#database-operations-overview" title="Permalink to this headline">¶</a></h2>
<p>Let us get an overview of Database Operation we typically perform on regular basis. They are broadly categorized into the following:</p>
<ul class="simple">
<li><p>DDL - Data Definition Language</p>
<ul>
<li><p>CREATE/ALTER/DROP Tables</p></li>
<li><p>CREATE/ALTER/DROP Indexes</p></li>
<li><p>Add constraints to tables</p></li>
<li><p>CREATE/ALTER/DROP Views</p></li>
<li><p>CREATE/ALTER/DROP Sequences</p></li>
</ul>
</li>
<li><p>DML - Data Manipulation Language</p>
<ul>
<li><p>Inserting new data into the table</p></li>
<li><p>Updating existing data in the table</p></li>
<li><p>Deleting existing data from the table</p></li>
</ul>
</li>
<li><p>DQL - Data Query Language</p>
<ul>
<li><p>Read the data from the table</p></li>
</ul>
</li>
</ul>
<p>On top of these we also use TCL (Transaction Control Language). As part of this section we will primarily focus on CRUD Operations which includes DML and basic DDL.</p>
</div>
<div class="section" id="crud-operations">
<h2>CRUD Operations<a class="headerlink" href="#crud-operations" title="Permalink to this headline">¶</a></h2>
<p>Let us get an overview of CRUD Operations. They are nothing but DML and queries to read the data while performing database operations.</p>
<ul class="simple">
<li><p>CRUD is widely used from application development perspective.</p></li>
<li><p>C - CREATE (INSERT)</p></li>
<li><p>R - READ (READ)</p></li>
<li><p>U - UPDATE (UPDATE)</p></li>
<li><p>D - DELETE (DELETE)</p></li>
</ul>
<p>As part of the application development process we perform CRUD Operations using REST APIs.</p>
</div>
<div class="section" id="creating-table">
<h2>Creating Table<a class="headerlink" href="#creating-table" title="Permalink to this headline">¶</a></h2>
<p>Before getting into action with respect to basic DML and queries or CRUD operations, we need to prepare tables.</p>
<p>At this time we have not covered DDL (to create objects such as table) yet. For now just create the table by copy pasting and we will get into concepts as part of the subsequent sections.</p>
<ul class="simple">
<li><p>Connect to the database.</p></li>
<li><p>Create the table.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> sql
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">7600</span><span class="n">c8b786e3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_line_magic</span><span class="p">(</span><span class="s1">&#39;load_ext&#39;</span><span class="p">,</span> <span class="s1">&#39;sql&#39;</span><span class="p">)</span>

<span class="nn">~/Projects/Internal/bootcamp/ilms/ilms-env/lib/python3.7/site-packages/IPython/core/interactiveshell.py</span> in <span class="ni">run_line_magic</span><span class="nt">(self, magic_name, line, _stack_depth)</span>
<span class="g g-Whitespace">   </span><span class="mi">2324</span>                 <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;local_ns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_local_scope</span><span class="p">(</span><span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2325</span>             <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2326</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2327</span>             <span class="k">return</span> <span class="n">result</span>
<span class="g g-Whitespace">   </span><span class="mi">2328</span> 

<span class="nn">&lt;decorator-gen-57&gt;</span> in <span class="ni">load_ext</span><span class="nt">(self, module_str)</span>

<span class="nn">~/Projects/Internal/bootcamp/ilms/ilms-env/lib/python3.7/site-packages/IPython/core/magic.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(f, *a, **k)</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>     <span class="c1"># but it&#39;s overkill for just that one bit of state.</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="k">def</span> <span class="nf">magic_deco</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">187</span>         <span class="n">call</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> 
<span class="g g-Whitespace">    </span><span class="mi">189</span>         <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>

<span class="nn">~/Projects/Internal/bootcamp/ilms/ilms-env/lib/python3.7/site-packages/IPython/core/magics/extension.py</span> in <span class="ni">load_ext</span><span class="nt">(self, module_str)</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span>         <span class="k">if</span> <span class="ow">not</span> <span class="n">module_str</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span>             <span class="k">raise</span> <span class="n">UsageError</span><span class="p">(</span><span class="s1">&#39;Missing module name.&#39;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">33</span>         <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">extension_manager</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="n">module_str</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">34</span> 
<span class="g g-Whitespace">     </span><span class="mi">35</span>         <span class="k">if</span> <span class="n">res</span> <span class="o">==</span> <span class="s1">&#39;already loaded&#39;</span><span class="p">:</span>

<span class="nn">~/Projects/Internal/bootcamp/ilms/ilms-env/lib/python3.7/site-packages/IPython/core/extensions.py</span> in <span class="ni">load_extension</span><span class="nt">(self, module_str)</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>             <span class="k">if</span> <span class="n">module_str</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span>                 <span class="k">with</span> <span class="n">prepended_to_syspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ipython_extension_dir</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">80</span>                     <span class="n">mod</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="n">module_str</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>                     <span class="k">if</span> <span class="n">mod</span><span class="o">.</span><span class="vm">__file__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ipython_extension_dir</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>                         <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;Loading extensions from </span><span class="si">{dir}</span><span class="s2"> is deprecated. &quot;</span>

<span class="nn">/usr/local/opt/python@3.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/importlib/__init__.py</span> in <span class="ni">import_module</span><span class="nt">(name, package)</span>
<span class="g g-Whitespace">    </span><span class="mi">125</span>                 <span class="k">break</span>
<span class="g g-Whitespace">    </span><span class="mi">126</span>             <span class="n">level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">127</span>     <span class="k">return</span> <span class="n">_bootstrap</span><span class="o">.</span><span class="n">_gcd_import</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">level</span><span class="p">:],</span> <span class="n">package</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span> 
<span class="g g-Whitespace">    </span><span class="mi">129</span> 

<span class="nn">/usr/local/opt/python@3.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_gcd_import</span><span class="nt">(name, package, level)</span>

<span class="nn">/usr/local/opt/python@3.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load</span><span class="nt">(name, import_)</span>

<span class="nn">/usr/local/opt/python@3.7/Frameworks/Python.framework/Versions/3.7/lib/python3.7/importlib/_bootstrap.py</span> in <span class="ni">_find_and_load_unlocked</span><span class="nt">(name, import_)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;sql&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">env</span> DATABASE_URL=postgresql://training:itversity!23@localhost:5432/training_sms
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM information_schema.tables LIMIT 10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span> result_set &lt;&lt;

CREATE TABLE users (
  user_id SERIAL PRIMARY KEY,
  user_first_name VARCHAR(30) NOT NULL,
  user_last_name VARCHAR(30) NOT NULL,
  user_email_id VARCHAR(50) NOT NULL,
  user_email_validated BOOLEAN DEFAULT FALSE,
  user_password VARCHAR(200),
  user_role VARCHAR(1) NOT NULL DEFAULT &#39;U&#39;, --U and A
  is_active BOOLEAN DEFAULT FALSE,
  create_ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  last_updated_ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Let us connect to psql and check the output of <code class="docutils literal notranslate"><span class="pre">\d</span></code>. You will see <strong>users table</strong> as well as <strong>sequence for user_id</strong> created.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inserting-data">
<h2>Inserting Data<a class="headerlink" href="#inserting-data" title="Permalink to this headline">¶</a></h2>
<p>Let us see how to insert the data into the table.</p>
<ul class="simple">
<li><p>We need to use INSERT clause to insert the data. Here is the sample syntax.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="o">&lt;</span><span class="n">table_name</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">)</span>
<span class="n">VALUES</span> <span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">val3</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If we don’t pass columns after table name then we need to specify values for all the columns. It is not good practice to insert records with out specifying column names.</p></li>
<li><p>If we do not specify value for <code class="docutils literal notranslate"><span class="pre">SERIAL</span></code> field, a sequence generated number will be used.</p></li>
<li><p>It is not mandatory to pass the values for those fields where <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> is specified. Values specified in <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> clause will be used.</p></li>
<li><p>It is mandatory to specify columns and corresponding values for all columns where <code class="docutils literal notranslate"><span class="pre">NOT</span> <span class="pre">NULL</span></code> is specified.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> sql
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">env</span> DATABASE_URL=postgresql://training:itversity!23@localhost:5432/training_sms
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> TRUNCATE TABLE users
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

INSERT INTO users (user_first_name, user_last_name, user_email_id)
VALUES (&#39;Scott&#39;, &#39;Tiger&#39;, &#39;scott@tiger.com&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

INSERT INTO users (user_first_name, user_last_name, user_email_id)
VALUES (&#39;Donald&#39;, &#39;Duck&#39;, &#39;donald@duck.com&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

INSERT INTO users (user_first_name, user_last_name, user_email_id, user_role, is_active)
VALUES (&#39;Mickey&#39;, &#39;Mouse&#39;, &#39;mickey@mouse.com&#39;, &#39;U&#39;, true)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

INSERT INTO users 
    (user_first_name, user_last_name, user_email_id, user_password, user_role, is_active) 
VALUES 
    (&#39;Gordan&#39;, &#39;Bradock&#39;, &#39;gbradock0@barnesandnoble.com&#39;, &#39;h9LAz7p7ub&#39;, &#39;U&#39;, true),
    (&#39;Tobe&#39;, &#39;Lyness&#39;, &#39;tlyness1@paginegialle.it&#39;, &#39;oEofndp&#39;, &#39;U&#39;, true),
    (&#39;Addie&#39;, &#39;Mesias&#39;, &#39;amesias2@twitpic.com&#39;, &#39;ih7Y69u56&#39;, &#39;U&#39;, true)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="updating-data">
<h2>Updating Data<a class="headerlink" href="#updating-data" title="Permalink to this headline">¶</a></h2>
<p>Let us see how we can update data in the table.</p>
<ul class="simple">
<li><p>Typical syntax</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="o">&lt;</span><span class="n">table_name</span><span class="o">&gt;</span>
<span class="n">SET</span>
    <span class="n">col1</span> <span class="o">=</span> <span class="n">val1</span><span class="p">,</span>
    <span class="n">col2</span> <span class="o">=</span> <span class="n">val2</span>
<span class="n">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> condition is specified all rows in the table will be updated.</p></li>
<li><p>For now we will see basic examples for update. One need to have good knowledge about <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause to take care of complex conditions.</p></li>
</ul>
<ul class="simple">
<li><p>Set user role for user_id 1 as ‘A’</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> UPDATE users SET user_role = &#39;A&#39; WHERE user_id = 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Set user_email_validated as well as is_active to true for all users</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">sql</span>

UPDATE users
SET
    user_email_validated = true,
    is_active = true
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="deleting-data">
<h2>Deleting Data<a class="headerlink" href="#deleting-data" title="Permalink to this headline">¶</a></h2>
<p>Let us understand how to delete the data from a table.</p>
<ul class="simple">
<li><p>Typical Syntax - <code class="docutils literal notranslate"><span class="pre">DELETE</span> <span class="pre">FROM</span> <span class="pre">&lt;table&gt;</span> <span class="pre">WHERE</span> <span class="pre">&lt;condition&gt;</span></code>.</p></li>
<li><p>If we do not specify condition, it will delete all the data from the table.</p></li>
<li><p>It is not recommended to use delete with out where condition to delete all the data (instead we should use <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>).</p></li>
<li><p>For now we will see basic examples for update. One need to have good knowledge about <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause to take care of complex conditions.</p></li>
</ul>
<ul class="simple">
<li><p>Delete all those records from users where the password is not set. We need to use <code class="docutils literal notranslate"><span class="pre">IS</span> <span class="pre">NULL</span></code> as condition to compare against Null values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> DELETE FROM users WHERE user_password IS NULL
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> SELECT * FROM users
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="overview-of-transactions">
<h2>Overview of Transactions<a class="headerlink" href="#overview-of-transactions" title="Permalink to this headline">¶</a></h2>
<p>Let us go through the details related to Transactions.</p>
<ul class="simple">
<li><p>We typically perform operations such as <code class="docutils literal notranslate"><span class="pre">COMMIT</span></code> and <code class="docutils literal notranslate"><span class="pre">ROLLBACK</span></code> via the applications.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COMMIT</span></code> will persist the changes in the database.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ROLLBACK</span></code> will revert the uncommitted changes in the database.</p></li>
<li><p>We typically rollback the uncommitted changes in a transaction if there is any exception as part of the application logic flow.</p></li>
<li><p>For example, once the order is placed all the items that are added to shopping cart will be rolled back if the payment using credit card fails.</p></li>
<li><p>By default every operation is typically committed in Postgres. We will get into the details related to transaction as part of application development later.</p></li>
<li><p>Commands such as <code class="docutils literal notranslate"><span class="pre">COMMIT</span></code>, <code class="docutils literal notranslate"><span class="pre">ROLLBACK</span></code> typically comes under TCL (Transaction Control Language)</p></li>
</ul>
</div>
<div class="section" id="exercise-database-operations">
<h2>Exercise - Database Operations<a class="headerlink" href="#exercise-database-operations" title="Permalink to this headline">¶</a></h2>
<p>Let’s create a table and perform database operations using direct SQL.</p>
<ul class="simple">
<li><p>Create table - <strong>courses</strong></p>
<ul>
<li><p>course_id - sequence generated integer and primary key</p></li>
<li><p>course_name - which holds alpha numeric or string values up to 60 characters</p></li>
<li><p>course_author - which holds the name of the author up to 40 characters</p></li>
<li><p>course_status - which holds one of these values (published, draft, inactive). Make sure to enforce to store one of these 3 values as part of course_status.</p></li>
<li><p>course_published_dt - which holds date type value.</p></li>
</ul>
</li>
<li><p>Insert data into courses using the data provided. Make sure id is system generated.</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Course Name</p></th>
<th class="head"><p>Course Author</p></th>
<th class="head"><p>Course Status</p></th>
<th class="head"><p>Course Published Date</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Programming using Python</p></td>
<td><p>Bob Dillon</p></td>
<td><p>published</p></td>
<td><p>2020-09-30</p></td>
</tr>
<tr class="row-odd"><td><p>Data Engineering using Python</p></td>
<td><p>Bob Dillon</p></td>
<td><p>published</p></td>
<td><p>2020-07-15</p></td>
</tr>
<tr class="row-even"><td><p>Data Engineering using Scala</p></td>
<td><p>Elvis Presley</p></td>
<td><p>draft</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Programming using Scala</p></td>
<td><p>Elvis Presley</p></td>
<td><p>published</p></td>
<td><p>2020-05-12</p></td>
</tr>
<tr class="row-even"><td><p>Programming using Java</p></td>
<td><p>Mike Jack</p></td>
<td><p>inactive</p></td>
<td><p>2020-08-10</p></td>
</tr>
<tr class="row-odd"><td><p>Web Applications - Python Flask</p></td>
<td><p>Bob Dillon</p></td>
<td><p>inactive</p></td>
<td><p>2020-07-20</p></td>
</tr>
<tr class="row-even"><td><p>Web Applications - Java Spring</p></td>
<td><p>Mike Jack</p></td>
<td><p>draft</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Pipeline Orchestration - Python</p></td>
<td><p>Bob Dillon</p></td>
<td><p>draft</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>Streaming Pipelines - Python</p></td>
<td><p>Bob Dillon</p></td>
<td><p>published</p></td>
<td><p>2020-10-05</p></td>
</tr>
<tr class="row-odd"><td><p>Web Applications - Scala Play</p></td>
<td><p>Elvis Presley</p></td>
<td><p>inactive</p></td>
<td><p>2020-09-30</p></td>
</tr>
<tr class="row-even"><td><p>Web Applications - Python Django</p></td>
<td><p>Bob Dillon</p></td>
<td><p>published</p></td>
<td><p>2020-06-23</p></td>
</tr>
<tr class="row-odd"><td><p>Server Automation - Ansible</p></td>
<td><p>Uncle Sam</p></td>
<td><p>published</p></td>
<td><p>2020-07-05</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Update the status of all the <strong>draft courses</strong> related to Python and Scala to <strong>published</strong> along with the <strong>course_published_dt using system date</strong>.</p></li>
<li><p>Delete all the courses which are neither in draft mode nor published.</p></li>
<li><p>Get count of all published courses by author and make sure output is sorted in descending order by count.</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Course Author</p></th>
<th class="head"><p>Course Count</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Bob Dillon</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>Elvis Presley</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Mike Jack</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Uncle Sam</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>